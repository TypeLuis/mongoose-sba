// MAKE SURE REST CLIENT IS INSTALLED TO USE THIS FILE
@baseUrl = http://localhost:3020
@json = application/json

# -----------------------------
# IDs (paste real ObjectIds here)
# -----------------------------
@userIdSeller = 65f000000000000000000001
@userIdBuyer  = 65f000000000000000000002

@listingId = 65f000000000000000000101
@offerId   = 65f000000000000000000201
@txId      = 65f000000000000000000301

# ============================================================
# USERS
# ============================================================

### Create user
POST {{baseUrl}}/api/users
Content-Type: {{json}}

{
  "username": "luis",
  "displayName": "Luis Lopez"
}

### Get all users
GET {{baseUrl}}/api/users

### Get user by id
GET {{baseUrl}}/api/users/{{userIdSeller}}

### Patch user (partial update)
PATCH {{baseUrl}}/api/users/{{userIdSeller}}
Content-Type: {{json}}

{
  "displayName": "Luis L."
}

### Put user (full replace)
PUT {{baseUrl}}/api/users/{{userIdSeller}}
Content-Type: {{json}}

{
  "username": "luis",
  "displayName": "Luis Lopez"
}

### Delete user
DELETE {{baseUrl}}/api/users/{{userIdSeller}}

# ============================================================
# LISTINGS
# ============================================================

### Create listing
POST {{baseUrl}}/api/listings
Content-Type: {{json}}

{
  "sellerId": "{{userIdSeller}}",
  "title": "Gaming Monitor 144Hz",
  "description": "27 inch 144Hz gaming monitor.",
  "category": "ELECTRONICS",
  "condition": "GOOD",
  "price": 250
}

### Get all listings (no filters)
GET {{baseUrl}}/api/listings

### Get listings filtered (category + status)
GET {{baseUrl}}/api/listings?category=ELECTRONICS&status=ACTIVE

### Get listings filtered (seller dashboard)
GET {{baseUrl}}/api/listings?sellerId={{userIdSeller}}

### Get listings filtered (price range)
GET {{baseUrl}}/api/listings?minPrice=50&maxPrice=300

### Search listings by title (regex contains, case-insensitive)
GET {{baseUrl}}/api/listings?q=monitor

### Get listing by id
GET {{baseUrl}}/api/listings/{{listingId}}

### Patch listing (partial update)
PATCH {{baseUrl}}/api/listings/{{listingId}}
Content-Type: {{json}}

{
  "price": 240,
  "description": "Price drop! 27 inch 144Hz, great condition."
}

### Put listing (full replace)
PUT {{baseUrl}}/api/listings/{{listingId}}
Content-Type: {{json}}

{
  "sellerId": "{{userIdSeller}}",
  "title": "Gaming Monitor 144Hz",
  "description": "27 inch 144Hz gaming monitor.",
  "category": "ELECTRONICS",
  "condition": "GOOD",
  "price": 240,
  "status": "ACTIVE"
}

### Delete listing
DELETE {{baseUrl}}/api/listings/{{listingId}}

# ============================================================
# OFFERS
# ============================================================

### Create offer on a listing
POST {{baseUrl}}/api/offers
Content-Type: {{json}}

{
  "listingId": "{{listingId}}",
  "buyerId": "{{userIdBuyer}}",
  "offerPrice": 220,
  "message": "Can pick up today if available."
}

### Get all offers (no filters)
GET {{baseUrl}}/api/offers

### Get offers for a listing (seller view)
GET {{baseUrl}}/api/offers?listingId={{listingId}}

### Get offers by buyer (buyer view)
GET {{baseUrl}}/api/offers?buyerId={{userIdBuyer}}

### Get offers by status
GET {{baseUrl}}/api/offers?status=PENDING

### Get offer by id
GET {{baseUrl}}/api/offers/{{offerId}}

### Withdraw offer (buyer)
PATCH {{baseUrl}}/api/offers/{{offerId}}/withdraw
Content-Type: {{json}}

{
  "buyerId": "{{userIdBuyer}}"
}

### Decline offer (seller)
PATCH {{baseUrl}}/api/offers/{{offerId}}/decline
Content-Type: {{json}}

{
  "sellerId": "{{userIdSeller}}"
}

### Accept offer (seller) â€” also declines other pending offers and marks listing SOLD
PATCH {{baseUrl}}/api/offers/{{offerId}}/accept
Content-Type: {{json}}

{
  "sellerId": "{{userIdSeller}}"
}

### Delete offer (hard delete)
# DELETE {{baseUrl}}/api/offers/{{offerId}}

# ============================================================
# TRANSACTIONS
# ============================================================

### Create transaction (finalize purchase from ACCEPTED offer)
POST {{baseUrl}}/api/transactions
Content-Type: {{json}}

{
  "offerId": "{{offerId}}",
  "sellerId": "{{userIdSeller}}"
}

### Get all transactions
GET {{baseUrl}}/api/transactions

### Get transactions by seller
GET {{baseUrl}}/api/transactions?sellerId={{userIdSeller}}

### Get transactions by buyer
GET {{baseUrl}}/api/transactions?buyerId={{userIdBuyer}}

### Get transactions by listing
GET {{baseUrl}}/api/transactions?listingId={{listingId}}

### Get transaction by id
GET {{baseUrl}}/api/transactions/{{txId}}



# ### Cancel transaction 
# PATCH {{baseUrl}}/api/transactions/{{txId}}/cancel
# Content-Type: {{json}}

# {
#   "sellerId": "{{userIdSeller}}"
# }

# ### Refund transaction 
# PATCH {{baseUrl}}/api/transactions/{{txId}}/refund
# Content-Type: {{json}}

# {
#   "sellerId": "{{userIdSeller}}"
# }

# ### Delete transaction
# DELETE {{baseUrl}}/api/transactions/{{txId}}
